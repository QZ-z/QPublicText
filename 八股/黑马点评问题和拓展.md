点评的升级点：

1. 分布式id的产生可以拓展雪花算法
2. 异步秒杀中加入消息队列
3. 实现多级缓存
4. redission实现集群环境下的分布式锁

遇到问题：

- 拦截器实现登录状态刷新，如果只拦截需要登录请求，那么只有这个时候token才会刷新，应拦截所有进行刷新，之后再设置拦截器，进行登录的验证
- StringRedisTemplate只能处理string类型，所以这里的处理是必不可少的，因为userDTO中存在long属性 

- 一人一单时候的锁粒度问题，优化之后userID的String类型防止每次toString创建新对象，要用intern放常量池中                                              
- 当前方法被spring的事务控制，如果你在方法内部加锁，可能会导致当前方法事务还没有提交，但是锁已经释放也会导致问题，所以我们选择将当前方法整体包裹起来，确保事务不会出现问题
- 同时不能使用this.进行调用，事务要想生效，要用的代理对象，即原始的事务对象
- 没有异步下单的时候，并发量低，异步下单的时候，下单子线程无法像之前获得事务代理对象，需要父线程获取之后传递给子线程

亮点：

- 乐观锁解决超卖
- 消息队列完成优惠券异步秒杀，一人一单
- 乐观锁解决超卖问题，升级redission分布式锁

